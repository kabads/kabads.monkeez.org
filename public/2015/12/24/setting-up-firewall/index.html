<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="generator" content="Hugo 0.36" />



<link rel="canonical" href="https://kabads.monkeez.org/2015/12/24/setting-up-firewall/">


    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <title>Setting up a firewall on Linux Ubuntu 14.04 - Kabads - musings, mutterings and murmerings</title>
    
<meta name="description" content="Uses Firewalls allow only particular access to particular network ports and paths. You can remove access to a port or a specific IP address or a range of IP addresses.Admins can apply rules according to what access they would like - these rules include both outgoing and incoming network traffic. This allows admins to build barriers of trust across machines.Modern firewalls are based on Application Layer Firewalls and are aware of the kinds of applications and protocols that the connection is using.">

<meta property="og:title" content="Setting up a firewall on Linux Ubuntu 14.04 - Kabads - musings, mutterings and murmerings">
<meta property="og:type" content="article">
<meta property="og:url" content="https://kabads.monkeez.org/2015/12/24/setting-up-firewall/">
<meta property="og:image" content="https://kabads.monkeez.org/images/default.png">
<meta property="og:site_name" content="Kabads - musings, mutterings and murmerings">
<meta property="og:description" content="Uses Firewalls allow only particular access to particular network ports and paths. You can remove access to a port or a specific IP address or a range of IP addresses.Admins can apply rules according to what access they would like - these rules include both outgoing and incoming network traffic. This allows admins to build barriers of trust across machines.Modern firewalls are based on Application Layer Firewalls and are aware of the kinds of applications and protocols that the connection is using.">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="Kabads - musings, mutterings and murmerings">
<meta name="twitter:url" content="https://kabads.monkeez.org/2015/12/24/setting-up-firewall/">
<meta name="twitter:title" content="Setting up a firewall on Linux Ubuntu 14.04 - Kabads - musings, mutterings and murmerings">
<meta name="twitter:description" content="Uses Firewalls allow only particular access to particular network ports and paths. You can remove access to a port or a specific IP address or a range of IP addresses.Admins can apply rules according to what access they would like - these rules include both outgoing and incoming network traffic. This allows admins to build barriers of trust across machines.Modern firewalls are based on Application Layer Firewalls and are aware of the kinds of applications and protocols that the connection is using.">
<meta name="twitter:image" content="https://kabads.monkeez.org/images/default.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https://kabads.monkeez.org/"
    },
    "headline": "Setting up a firewall on Linux Ubuntu 14.04 - Kabads - musings, mutterings and murmerings",
    "image": {
      "@type": "ImageObject",
      "url": "https://kabads.monkeez.org/images/default.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2015-12-24T00:00:00JST",
    "dateModified": "2015-12-24T00:00:00JST",
    "author": {
      "@type": "Person",
      "name": "Kabads - musings, mutterings and murmerings"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Kabads - musings, mutterings and murmerings",
      "logo": {
        "@type": "ImageObject",
        "url": "https://kabads.monkeez.org/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "Uses Firewalls allow only particular access to particular network ports and paths. You can remove access to a port or a specific IP address or a range of IP addresses.
Admins can apply rules according to what access they would like - these rules include both outgoing and incoming network traffic. This allows admins to build barriers of trust across machines.
Modern firewalls are based on Application Layer Firewalls and are aware of the kinds of applications and protocols that the connection is using."
  }
</script>


    <link href="https://kabads.monkeez.org/css/styles.css" rel="stylesheet">
    

  </head>

  <body>
    
    
    

    <header class="l-header">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://kabads.monkeez.org/">Kabads - musings, mutterings and murmerings</a>
          </div>

          

        </div>
      </nav>
    </header>

    <main>
      <div class="container">
        
<div class="row">
  <div class="col-md-8">

    <nav class="p-crumb">
      <ol class="breadcrumb">
        <li><a href="https://kabads.monkeez.org/"><i class="fa fa-home" aria-hidden="true"></i></a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://kabads.monkeez.org/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li class="active">Setting up a firewall on Linux Ubuntu 14.04</li>
      </ol>
    </nav>

    <article class="single">
  <header>
    <ul class="p-facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2015-12-24T00:00:00JST">Dec 24, 2015</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="https://kabads.monkeez.org/post/">post</a></li>
      
    </ul>

    <h1 class="title">Setting up a firewall on Linux Ubuntu 14.04</h1>
  </header>

  

  <div class="article-body">

<h2 id="uses">Uses</h2>

<p>Firewalls allow only particular access to particular network ports and paths. You can remove access to a port or a specific IP address or a range of IP addresses.</p>

<p>Admins can apply rules according to what access they would like - these rules include both outgoing and incoming network traffic. This allows admins to build barriers of trust across machines.</p>

<p>Modern firewalls are based on <a href="https://en.wikipedia.org/wiki/Application_firewall"><em>Application Layer Firewalls</em></a> and are aware of the kinds of applications and protocols that the connection is using. They can block anything which is not part of the normal flow of traffic.</p>

<h2 id="set-up">Set up</h2>

<p>The <strong>firewalld</strong> package needs to be installed:</p>

<pre><code>$ sudo aptitude install firewalld 
</code></pre>

<p>You should not run the program <strong>iptables</strong> alongside <strong>firewalld</strong> as this is the older version and will create a conflict.</p>

<p><strong>firewalld</strong> is a service which needs to be running to use and configure the firewall, and is started in the usual way.</p>

<pre><code>$ sudo /etc/init.d/firewalld start 
</code></pre>

<p>You can test if the service is running with:</p>

<pre><code>$ sudo firewall-cmd --state
</code></pre>

<p>If you have more than one network interface on IPV4, you will need to turn on <strong>ip forwarding</strong>. This is achieved with:</p>

<pre><code>$ sudo sysctl net.ipv4.ip_forward=1
</code></pre>

<p>However, this is not persistent across boots. To achieve this, you will need to add the following line to <em>/etc/sysctl.conf</em>:</p>

<pre><code>net.ipv4.ip_forward=1 
</code></pre>

<p>and then reboot or type:</p>

<pre><code>$ sudo sysctl -p 
</code></pre>

<p>to read in the new setting.</p>

<h3 id="zones">Zones</h3>

<p>Firewalls work with <strong>zones</strong> each which has a level of trust defined. The zones are</p>

<ul>
<li><strong>drop</strong> - only particular incoming connections are allowed</li>
<li><strong>block</strong> - all incoming connections are rejected</li>
<li><strong>public</strong> - do not trust any computers on the network; only defined incoming connections are permitted</li>
<li><strong>external</strong> - used when <em>masquerading</em> is being used, usually in routers.</li>
<li><strong>dmz</strong> - used when access is allowed only to some services to the public.</li>
<li><strong>work</strong> - trust connected nodes to be not harmful</li>
<li><strong>home</strong> - mostly trust other network nodes, but still select which incoming connections are allowed</li>
<li><strong>internal</strong> - similar to work zone</li>
<li><strong>trusted</strong> - everything is allowed.</li>
</ul>

<p>On installation, nearly all Linux distributions will select the <strong>public</strong> zone as the default for all interfaces.</p>

<p>Get the default zone:</p>

<pre><code>$ sudo firewall-cmd --get-default-zone
</code></pre>

<p>Obtain a list of zones being used:</p>

<pre><code>$ sudo firewall-cmd --get-active-zones 
</code></pre>

<p>List all available zones:</p>

<pre><code>$ sudo firewall-cmd --get-zones 
</code></pre>

<p>To change the default zone to <strong>trusted</strong> and then change it back.</p>

<pre><code>$ sudo firewall-cmd --set-default-zone=trusted

$ sudo firewall-cmd --set-default-zone=public
</code></pre>

<p>To assign an interface temporarily to a particular zone:</p>

<pre><code>$ sudo firewall-cmd --zone=internal --change-interface=eth0
</code></pre>

<p>This will only change the interface until the next boot. To make it permanent, we add the <strong>&ndash;permanent</strong> flag.</p>

<pre><code>$ sudo firewall-cmd --permanent --zone=internal --change-interface=eth0
</code></pre>

<p>which will create a file in <strong>/etc/firewalld/zones/internal.xml</strong>.</p>

<p>To ascertain the zone associated with a particular interface:</p>

<pre><code>$ sudo firewall-cmd --get-zone-of-interface=eth0
</code></pre>

<p>To get the details of a particular zone:</p>

<pre><code>$ sudo firewall-cmd --zone=public --list-all 
</code></pre>

<p>An admin can also bind a zone to a network address (as well as an interface).</p>

<p>To bind a source to a zone:</p>

<pre><code>$ sudo firewall-cmd --permanent --zone=trusted --add-source=192.168.1.0/24
</code></pre>

<p>With this command, anyone from address 192.168.1.x will be added to the <strong>trusted</strong> zone.</p>

<h3 id="services-and-ports-within-a-zone">Services and ports within a zone</h3>

<p>Setting zones is now possible, but for these to become effective, we need to set particular services within each zone.</p>

<p>We can see what services are associated with a particular zone:</p>

<pre><code>$ sudo firewall-cmd --list-services --zone=public
</code></pre>

<p>To add a service to a zone:</p>

<pre><code>$ sudo firewall-cmd --permanent --zone=work --add-service=http
$ sudo firewall-cmd --reload 
</code></pre>

<p><strong>&ndash;reload</strong> is required to make the change effective and <strong>&ndash;permanent</strong> is required to add a service to a zone.</p>

<p>Port management is very similar:</p>

<pre><code>$ sudo firewall-cmd --zone=work --add-port=21/tcp
$ sudo firewall-cmd --reload 
</code></pre>

<p>You can also remove these with the commands <strong>&ndash;remove-service</strong> and <strong>&ndash;remove-port</strong>.</p>
</div>

  <footer class="article-footer">
    
    
    
    <section class="bordered">
      <header>
        <div class="panel-title">CATEGORIES</div>
      </header>
      <div>
        <ul class="p-terms">
          
          <li><a href="https://kabads.monkeez.org/categories/sysadmin/">sysadmin</a></li>
          
        </ul>
      </div>
    </section>
    
    
    
    
  </footer>

</article>


    
  </div>

  <div class="col-md-4">
    
<aside class="l-sidebar">

  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">LATESTS</div>
    </div>
    <div class="list-group">
      
      <a href="https://kabads.monkeez.org/post/2018-02-11-cycle-jaunt-around-bath/" class="list-group-item">2018 02 11 Cycle Jaunt Around Bath</a>
      
      <a href="https://kabads.monkeez.org/2017/10/03/aws-how-to-automatically-launch-apache-with-your-site-content/" class="list-group-item">How to create an instance that pulls your website content automatically</a>
      
      <a href="https://kabads.monkeez.org/2017/09/20/how-to-create-a-vpc/" class="list-group-item">AWS - How to Create A VPC</a>
      
      <a href="https://kabads.monkeez.org/2017/09/20/aws-how-to-serve-traffic-from-load-balancer/" class="list-group-item">AWS - How to Serve Traffic from a Load Balancer</a>
      
      <a href="https://kabads.monkeez.org/2017/07/02/swindon-to-goring-walk/" class="list-group-item">TADS walk Swindon to Goring</a>
      
      <a href="https://kabads.monkeez.org/2017/06/10/how-to-install-lineageos-wileyfox-swift/" class="list-group-item">How to install LineageOS on Wileyfox Swift</a>
      
      <a href="https://kabads.monkeez.org/2017/05/06/a-cartoon-about-file-permissions/" class="list-group-item">A Cartoon About File Permissions</a>
      
      <a href="https://kabads.monkeez.org/2017/01/29/setting-up-lets-encrypt-with-certauto/" class="list-group-item">Setting up SSL Certificates with Lets Encrypt and certbot</a>
      
      <a href="https://kabads.monkeez.org/2016/12/10/running-ec2-instance/" class="list-group-item">Running EC2 Instance</a>
      
      <a href="https://kabads.monkeez.org/2016/11/20/finding-large-files-in-a-directory/" class="list-group-item">Finding large files in a directory</a>
      
    </div>
  </section>

  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">CATEGORY</div>
    </div>
    <div class="list-group">
      
      <a href="https://kabads.monkeez.org/categories/sysadmin" class="list-group-item">sysadmin</a>
      
      <a href="https://kabads.monkeez.org/categories/cycling" class="list-group-item">cycling</a>
      
      <a href="https://kabads.monkeez.org/categories/education" class="list-group-item">education</a>
      
      <a href="https://kabads.monkeez.org/categories/exercise" class="list-group-item">exercise</a>
      
      <a href="https://kabads.monkeez.org/categories/leisure" class="list-group-item">leisure</a>
      
      <a href="https://kabads.monkeez.org/categories/reading" class="list-group-item">reading</a>
      
      <a href="https://kabads.monkeez.org/categories/tech" class="list-group-item">tech</a>
      
    </div>
  </section>
  
  <section class="panel panel-default">
    <div class="panel-heading">
      <div class="panel-title">TAG</div>
    </div>
    <div class="list-group">
      
      <a href="https://kabads.monkeez.org/tags/ict" class="list-group-item">ict</a>
      
    </div>
  </section>
  

</aside>


  </div>
</div>

      </div>
    </main>

    <footer class="l-footer">
      <div class="container">
        <p><span class="h-logo">&copy; Kabads - musings, mutterings and murmerings</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_beg">Beg</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

